<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>zBox</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body ng-app="myApp" ng-controller="myCtrl">
    <h1>zBox</h1>

    <button ng-click="Freeze(app.pkg_name, true)">冻结</button>

    <br />
    <br />

    <button ng-click="Freeze(app.pkg_name, false)">解冻</button>

    <ul>
        <li ng-repeat="app in apps" ng-click="Freeze(app.pkg_name, !app.is_hidden)">{{app.app_name}} {{app.pkg_name}}</li>
    </ul>

    <script src="js/jquery-3.0.0.min.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/apps.js"></script>
<script>
    var weekday_zh = ["日", "一", "二", "三", "四", "五", "六"];
    var KEYGUARD_SHOWN = 17;  //锁屏
    var KEYGUARD_HIDDEN = 18; //解锁
    var app = angular.module('myApp', []);
    function compare(a, b) {
        if (a.sec_of_day < b.sec_of_day) {
            return -1;
        }
        if (a.sec_of_day > b.sec_of_day) {
            return 1;
        }
        return 0;
    }
    // (new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423
    // (new Date()).Format("yyyy-M-d h:m:s.S")      ==> 2006-7-2 8:9:4.18
    Date.prototype.Format = function(fmt) {
        var o = {
            "M+" : this.getMonth()+1,                 //月份
            "d+" : this.getDate(),                    //日
            "h+" : this.getHours(),                   //小时
            "m+" : this.getMinutes(),                 //分
            "s+" : this.getSeconds(),                 //秒
            "q+" : Math.floor((this.getMonth()+3)/3), //季度
            "S"  : this.getMilliseconds()             //毫秒
        };
        if(/(y+)/.test(fmt))
            fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
            if(new RegExp("("+ k +")").test(fmt))
        fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
        return fmt;
    }

    //从这开始
    var apps = apps_test;
    if (window.navigator.userAgent.indexOf("Edg") == -1) {
        apps = window.JsServer.GetAppList();
        apps = JSON.parse(apps);
    }

    app.controller('myCtrl', function($scope, $http) {
        $scope.apps = apps;

        $scope.Freeze = function(pkg_name, hidden) {
            window.JsServer.Freeze(pkg_name, hidden);
            var mess = " 已冻结";
            if (!hidden) mess = " 已解冻";
            alert(pkg_name + mess);
        }

    });
</script>
</body>
</html>